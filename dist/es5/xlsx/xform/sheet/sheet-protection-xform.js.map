{"version":3,"file":"sheet-protection-xform.js","names":["_","require","BaseXform","booleanToXml","model","value","undefined","xmlToBoolean","equals","SheetProtectionXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","render","xmlStream","attributes","sheet","selectLockedCells","selectUnlockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables","algorithmName","hashValue","saltValue","spinCount","objects","scenarios","some","leafNode","tag","parseOpen","node","name","parseInt","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-protection-xform.js"],"sourcesContent":["const _ = require('../../../utils/under-dash');\nconst BaseXform = require('../base-xform');\n\nfunction booleanToXml(model, value) {\n  return model ? value : undefined;\n}\n\nfunction xmlToBoolean(value, equals) {\n  return value === equals ? true : undefined;\n}\n\nclass SheetProtectionXform extends BaseXform {\n  get tag() {\n    return 'sheetProtection';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      const attributes = {\n        sheet: booleanToXml(model.sheet, '1'),\n        selectLockedCells: model.selectLockedCells === false ? '1' : undefined,\n        selectUnlockedCells: model.selectUnlockedCells === false ? '1' : undefined,\n        formatCells: booleanToXml(model.formatCells, '0'),\n        formatColumns: booleanToXml(model.formatColumns, '0'),\n        formatRows: booleanToXml(model.formatRows, '0'),\n        insertColumns: booleanToXml(model.insertColumns, '0'),\n        insertRows: booleanToXml(model.insertRows, '0'),\n        insertHyperlinks: booleanToXml(model.insertHyperlinks, '0'),\n        deleteColumns: booleanToXml(model.deleteColumns, '0'),\n        deleteRows: booleanToXml(model.deleteRows, '0'),\n        sort: booleanToXml(model.sort, '0'),\n        autoFilter: booleanToXml(model.autoFilter, '0'),\n        pivotTables: booleanToXml(model.pivotTables, '0'),\n      };\n      if (model.sheet) {\n        attributes.algorithmName = model.algorithmName;\n        attributes.hashValue = model.hashValue;\n        attributes.saltValue = model.saltValue;\n        attributes.spinCount = model.spinCount;\n        attributes.objects = booleanToXml(model.objects === false, '1');\n        attributes.scenarios = booleanToXml(model.scenarios === false, '1');\n      }\n      if (_.some(attributes, value => value !== undefined)) {\n        xmlStream.leafNode(this.tag, attributes);\n      }\n    }\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case this.tag:\n        this.model = {\n          sheet: xmlToBoolean(node.attributes.sheet, '1'),\n          objects: node.attributes.objects === '1' ? false : undefined,\n          scenarios: node.attributes.scenarios === '1' ? false : undefined,\n          selectLockedCells: node.attributes.selectLockedCells === '1' ? false : undefined,\n          selectUnlockedCells: node.attributes.selectUnlockedCells === '1' ? false : undefined,\n          formatCells: xmlToBoolean(node.attributes.formatCells, '0'),\n          formatColumns: xmlToBoolean(node.attributes.formatColumns, '0'),\n          formatRows: xmlToBoolean(node.attributes.formatRows, '0'),\n          insertColumns: xmlToBoolean(node.attributes.insertColumns, '0'),\n          insertRows: xmlToBoolean(node.attributes.insertRows, '0'),\n          insertHyperlinks: xmlToBoolean(node.attributes.insertHyperlinks, '0'),\n          deleteColumns: xmlToBoolean(node.attributes.deleteColumns, '0'),\n          deleteRows: xmlToBoolean(node.attributes.deleteRows, '0'),\n          sort: xmlToBoolean(node.attributes.sort, '0'),\n          autoFilter: xmlToBoolean(node.attributes.autoFilter, '0'),\n          pivotTables: xmlToBoolean(node.attributes.pivotTables, '0'),\n        };\n        if (node.attributes.algorithmName) {\n          this.model.algorithmName = node.attributes.algorithmName;\n          this.model.hashValue = node.attributes.hashValue;\n          this.model.saltValue = node.attributes.saltValue;\n          this.model.spinCount = parseInt(node.attributes.spinCount, 10);\n        }\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = SheetProtectionXform;\n"],"mappings":"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"}