{"version":3,"file":"header-footer-xform.js","names":["BaseXform","require","HeaderFooterXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","value","render","xmlStream","model","addRollback","createTag","openNode","differentFirst","addAttribute","differentOddEven","oddHeader","leafNode","oddFooter","evenHeader","evenFooter","firstHeader","firstFooter","closeNode","commit","rollback","parseOpen","node","name","attributes","parseInt","currentNode","parseText","text","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/header-footer-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nclass HeaderFooterXform extends BaseXform {\n  get tag() {\n    return 'headerFooter';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.addRollback();\n\n      let createTag = false;\n\n      xmlStream.openNode('headerFooter');\n      if (model.differentFirst) {\n        xmlStream.addAttribute('differentFirst', '1');\n        createTag = true;\n      }\n      if (model.differentOddEven) {\n        xmlStream.addAttribute('differentOddEven', '1');\n        createTag = true;\n      }\n      if (model.oddHeader && typeof model.oddHeader === 'string') {\n        xmlStream.leafNode('oddHeader', null, model.oddHeader);\n        createTag = true;\n      }\n      if (model.oddFooter && typeof model.oddFooter === 'string') {\n        xmlStream.leafNode('oddFooter', null, model.oddFooter);\n        createTag = true;\n      }\n      if (model.evenHeader && typeof model.evenHeader === 'string') {\n        xmlStream.leafNode('evenHeader', null, model.evenHeader);\n        createTag = true;\n      }\n      if (model.evenFooter && typeof model.evenFooter === 'string') {\n        xmlStream.leafNode('evenFooter', null, model.evenFooter);\n        createTag = true;\n      }\n      if (model.firstHeader && typeof model.firstHeader === 'string') {\n        xmlStream.leafNode('firstHeader', null, model.firstHeader);\n        createTag = true;\n      }\n      if (model.firstFooter && typeof model.firstFooter === 'string') {\n        xmlStream.leafNode('firstFooter', null, model.firstFooter);\n        createTag = true;\n      }\n\n      if (createTag) {\n        xmlStream.closeNode();\n        xmlStream.commit();\n      } else {\n        xmlStream.rollback();\n      }\n    }\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case 'headerFooter':\n        this.model = {};\n        if (node.attributes.differentFirst) {\n          this.model.differentFirst = parseInt(node.attributes.differentFirst, 0) === 1;\n        }\n        if (node.attributes.differentOddEven) {\n          this.model.differentOddEven = parseInt(node.attributes.differentOddEven, 0) === 1;\n        }\n        return true;\n\n      case 'oddHeader':\n        this.currentNode = 'oddHeader';\n        return true;\n\n      case 'oddFooter':\n        this.currentNode = 'oddFooter';\n        return true;\n\n      case 'evenHeader':\n        this.currentNode = 'evenHeader';\n        return true;\n\n      case 'evenFooter':\n        this.currentNode = 'evenFooter';\n        return true;\n\n      case 'firstHeader':\n        this.currentNode = 'firstHeader';\n        return true;\n\n      case 'firstFooter':\n        this.currentNode = 'firstFooter';\n        return true;\n\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    switch (this.currentNode) {\n      case 'oddHeader':\n        this.model.oddHeader = text;\n        break;\n\n      case 'oddFooter':\n        this.model.oddFooter = text;\n        break;\n\n      case 'evenHeader':\n        this.model.evenHeader = text;\n        break;\n\n      case 'evenFooter':\n        this.model.evenFooter = text;\n        break;\n\n      case 'firstHeader':\n        this.model.firstHeader = text;\n        break;\n\n      case 'firstFooter':\n        this.model.firstFooter = text;\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  parseClose() {\n    switch (this.currentNode) {\n      case 'oddHeader':\n      case 'oddFooter':\n      case 'evenHeader':\n      case 'evenFooter':\n      case 'firstHeader':\n      case 'firstFooter':\n        this.currentNode = undefined;\n        return true;\n\n      default:\n        return false;\n    }\n  }\n}\n\nmodule.exports = HeaderFooterXform;\n"],"mappings":"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"}