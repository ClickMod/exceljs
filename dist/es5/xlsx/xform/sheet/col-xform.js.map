{"version":3,"file":"col-xform.js","names":["utils","require","BaseXform","ColXform","_BaseXform","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","value","prepare","model","options","styleId","styles","addStyleModel","style","render","xmlStream","openNode","addAttribute","min","max","width","hidden","bestFit","outlineLevel","collapsed","closeNode","parseOpen","node","name","parseInt","attributes","undefined","parseFloat","parseBoolean","parseText","parseClose","reconcile","getStyleModel","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/col-xform.js"],"sourcesContent":["const utils = require('../../../utils/utils');\nconst BaseXform = require('../base-xform');\n\nclass ColXform extends BaseXform {\n  get tag() {\n    return 'col';\n  }\n\n  prepare(model, options) {\n    const styleId = options.styles.addStyleModel(model.style || {});\n    if (styleId) {\n      model.styleId = styleId;\n    }\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode('col');\n    xmlStream.addAttribute('min', model.min);\n    xmlStream.addAttribute('max', model.max);\n    if (model.width) {\n      xmlStream.addAttribute('width', model.width);\n    }\n    if (model.styleId) {\n      xmlStream.addAttribute('style', model.styleId);\n    }\n    if (model.hidden) {\n      xmlStream.addAttribute('hidden', '1');\n    }\n    if (model.bestFit) {\n      xmlStream.addAttribute('bestFit', '1');\n    }\n    if (model.outlineLevel) {\n      xmlStream.addAttribute('outlineLevel', model.outlineLevel);\n    }\n    if (model.collapsed) {\n      xmlStream.addAttribute('collapsed', '1');\n    }\n    xmlStream.addAttribute('customWidth', '1');\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (node.name === 'col') {\n      const model = (this.model = {\n        min: parseInt(node.attributes.min || '0', 10),\n        max: parseInt(node.attributes.max || '0', 10),\n        width:\n          node.attributes.width === undefined\n            ? undefined\n            : parseFloat(node.attributes.width || '0'),\n      });\n      if (node.attributes.style) {\n        model.styleId = parseInt(node.attributes.style, 10);\n      }\n      if (utils.parseBoolean(node.attributes.hidden)) {\n        model.hidden = true;\n      }\n      if (utils.parseBoolean(node.attributes.bestFit)) {\n        model.bestFit = true;\n      }\n      if (node.attributes.outlineLevel) {\n        model.outlineLevel = parseInt(node.attributes.outlineLevel, 10);\n      }\n      if (utils.parseBoolean(node.attributes.collapsed)) {\n        model.collapsed = true;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n\n  reconcile(model, options) {\n    // reconcile column styles\n    if (model.styleId) {\n      model.style = options.styles.getStyleModel(model.styleId);\n    }\n  }\n}\n\nmodule.exports = ColXform;\n"],"mappings":"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"}