{"version":3,"file":"cf-rule-ext-xform.js","names":["_require","require","uuidv4","v4","BaseXform","CompositeXform","DatabarExtXform","IconSetExtXform","extIcons","CfRuleExtXform","_CompositeXform","_inherits","_super","_createSuper","_this","_classCallCheck","call","map","databarXform","iconSetXform","_createClass","key","get","value","prepare","model","isExt","x14Id","concat","toUpperCase","render","xmlStream","type","renderDataBar","renderIconSet","openNode","tag","id","closeNode","priority","createNewModel","_ref","attributes","toIntValue","onParserClose","name","parser","Object","assign","rule","custom","iconSet","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/cf-rule-ext-xform.js"],"sourcesContent":["const {v4: uuidv4} = require('uuid');\nconst BaseXform = require('../../base-xform');\nconst CompositeXform = require('../../composite-xform');\n\nconst DatabarExtXform = require('./databar-ext-xform');\nconst IconSetExtXform = require('./icon-set-ext-xform');\n\nconst extIcons = {\n  '3Triangles': true,\n  '3Stars': true,\n  '5Boxes': true,\n};\n\nclass CfRuleExtXform extends CompositeXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'x14:dataBar': (this.databarXform = new DatabarExtXform()),\n      'x14:iconSet': (this.iconSetXform = new IconSetExtXform()),\n    };\n  }\n\n  get tag() {\n    return 'x14:cfRule';\n  }\n\n  static isExt(rule) {\n    // is this rule primitive?\n    if (rule.type === 'dataBar') {\n      return DatabarExtXform.isExt(rule);\n    }\n    if (rule.type === 'iconSet') {\n      if (rule.custom || extIcons[rule.iconSet]) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  prepare(model) {\n    if (CfRuleExtXform.isExt(model)) {\n      model.x14Id = `{${uuidv4()}}`.toUpperCase();\n    }\n  }\n\n  render(xmlStream, model) {\n    if (!CfRuleExtXform.isExt(model)) {\n      return;\n    }\n\n    switch (model.type) {\n      case 'dataBar':\n        this.renderDataBar(xmlStream, model);\n        break;\n      case 'iconSet':\n        this.renderIconSet(xmlStream, model);\n        break;\n    }\n  }\n\n  renderDataBar(xmlStream, model) {\n    xmlStream.openNode(this.tag, {\n      type: 'dataBar',\n      id: model.x14Id,\n    });\n\n    this.databarXform.render(xmlStream, model);\n\n    xmlStream.closeNode();\n  }\n\n  renderIconSet(xmlStream, model) {\n    xmlStream.openNode(this.tag, {\n      type: 'iconSet',\n      priority: model.priority,\n      id: model.x14Id || `{${uuidv4()}}`,\n    });\n\n    this.iconSetXform.render(xmlStream, model);\n\n    xmlStream.closeNode();\n  }\n\n  createNewModel({attributes}) {\n    return {\n      type: attributes.type,\n      x14Id: attributes.id,\n      priority: BaseXform.toIntValue(attributes.priority),\n    };\n  }\n\n  onParserClose(name, parser) {\n    Object.assign(this.model, parser.model);\n  }\n}\n\nmodule.exports = CfRuleExtXform;\n"],"mappings":"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"}