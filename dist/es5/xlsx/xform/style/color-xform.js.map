{"version":3,"file":"color-xform.js","names":["BaseXform","require","ColorXform","_BaseXform","_inherits","_super","_createSuper","name","_this","_classCallCheck","call","_createClass","key","get","value","render","xmlStream","model","openNode","argb","addAttribute","theme","undefined","tint","indexed","closeNode","parseOpen","node","attributes","rgb","parseInt","parseFloat","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/color-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\n// Color encapsulates translation from color model to/from xlsx\nclass ColorXform extends BaseXform {\n  constructor(name) {\n    super();\n\n    // this.name controls the xm node name\n    this.name = name || 'color';\n  }\n\n  get tag() {\n    return this.name;\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      xmlStream.openNode(this.name);\n      if (model.argb) {\n        xmlStream.addAttribute('rgb', model.argb);\n      } else if (model.theme !== undefined) {\n        xmlStream.addAttribute('theme', model.theme);\n        if (model.tint !== undefined) {\n          xmlStream.addAttribute('tint', model.tint);\n        }\n      } else if (model.indexed !== undefined) {\n        xmlStream.addAttribute('indexed', model.indexed);\n      } else {\n        xmlStream.addAttribute('auto', '1');\n      }\n      xmlStream.closeNode();\n      return true;\n    }\n    return false;\n  }\n\n  parseOpen(node) {\n    if (node.name === this.name) {\n      if (node.attributes.rgb) {\n        this.model = {argb: node.attributes.rgb};\n      } else if (node.attributes.theme) {\n        this.model = {theme: parseInt(node.attributes.theme, 10)};\n        if (node.attributes.tint) {\n          this.model.tint = parseFloat(node.attributes.tint);\n        }\n      } else if (node.attributes.indexed) {\n        this.model = {indexed: parseInt(node.attributes.indexed, 10)};\n      } else {\n        this.model = undefined;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = ColorXform;\n"],"mappings":"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"}